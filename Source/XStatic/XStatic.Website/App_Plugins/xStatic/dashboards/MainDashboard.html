<div data-ng-controller="xStaticMainDashboardController as vm">
    <umb-drawer-view>

        <umb-drawer-header title="Manage generated static sites"
                           description="This dashboard can be used to trigger builds of the static sites configured within Umbraco. To change settings for each static site use the tree to create and edit the settings.">
        </umb-drawer-header>

        <umb-drawer-content>

            <umb-box data-ng-repeat="site in vm.sites">
                <umb-box-header title="{{site.Name}}" data-ng-show="site.AutoPublish == true">
                    <umb-badge color="warning">Auto Deploy</umb-badge>
                </umb-box-header>

                <umb-box-header title="{{site.Name}}" data-ng-show="site.AutoPublish == false">
                    <umb-badge color="gray">Manual Deploy</umb-badge>
                </umb-box-header>

                <umb-box-content>
                    <div class="umb-panel-group__details-check">
                        <div class="umb-panel-group__details-check-title">
                            <div class="umb-panel-group__details-check-name" data-ng-show="!site.LastRun">This site has never been built.</div>
                            <div class="umb-panel-group__details-check-name" data-ng-show="site.LastRun">This static site was last generated on {{site.LastRun | date:'dd MMM yy'}} at {{site.LastRun | date:'HH:mm'}}</div>
                        </div>
                        <!-- Root -->
                        <div class="umb-panel-group__details-status">

                            <div class="umb-panel-group__details-status-icon-container">
                                <i class="umb-panel-status-icon icon-home" aria-hidden="true"></i>
                            </div>

                            <div class="umb-panel-group__details-status-content">
                                <div class="umb-panel-group__details-status-text">
                                    <span style="color:#999;">Root:</span> {{site.RootPath}}
                                </div>
                            </div>
                        </div>

                        <!-- Export Type -->

                        <div class="umb-panel-group__details-status" data-ng-show="site.ExportFormat == 'api'">

                            <div class="umb-panel-group__details-status-icon-container">
                                <i class="umb-panel-status-icon icon-brackets" aria-hidden="true"></i>
                            </div>

                            <div class="umb-panel-group__details-status-content">
                                <div class="umb-panel-group__details-status-text">
                                    Exports as a JSON API
                                </div>
                            </div>
                        </div>

                        <div class="umb-panel-group__details-status" data-ng-show="site.ExportFormat == 'html'">

                            <div class="umb-panel-group__details-status-icon-container">
                                <i class="umb-panel-status-icon icon-globe-alt" aria-hidden="true"></i>
                            </div>

                            <div class="umb-panel-group__details-status-content">
                                <div class="umb-panel-group__details-status-text">
                                    Exports as an HTML website
                                </div>
                            </div>
                        </div>


                    </div>

                    <div>
                        <umb-button action="vm.generateSite(site.Id)"
                                    type="button"
                                    button-style="success"
                                    label="Deploy updated content"
                                    disabled="false">
                        </umb-button>

                        <umb-button action="vm.generateSite(site.Id)"
                                    type="button"
                                    button-style="danger"
                                    label="Rebuild and redeploy site"
                                    disabled="false">
                        </umb-button>
                    </div>

                </umb-box-content>
            </umb-box>

        </umb-drawer-content>
        <umb-drawer-footer>
            <umb-button ng-click="vm.generate()"
                        type="button"
                        button-style="danger"
                        label="Rebuild all static sites"
                        disabled="false">
            </umb-button>
        </umb-drawer-footer>

    </umb-drawer-view>


</div>